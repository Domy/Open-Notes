# 图解HTTP

## 了解Web及网络基础

Web是建立在HTTP协议上通信的。

### 网络基础 TCP/IP

计算机与网络设备要相互通信，双方就必须基于相同的方法。如，如何探测到通信目标、由哪一边先发起通信、使用哪一种语言进行通信、怎样结束通信等规则都需要事先确定。不同的硬件、操作系统之间的通信，所有这一切都需要一种规则。而我们就把这种规则称为协议（protocol）。

TCP/IP是互联网相关的各类协议族的总称。而HTTP属于它内部的一个子集。

#### TCP/IP的分层管理

TCP/IP协议族里最重要的一点就是分层。TCP/IP协议族按层次分别分为以下4层：应用层、传输层、网络层和数据链路层。

TCP/IP协议族各层的作用如下：

* 应用层：决定了向用户提供应用服务时通信的活动。HTTP协议处于该层。
* 传输层：传输层对上层应用层，提供处于网络连接中的两台计算机之间的数据传输。
* 网络层：用来处理在网络上流动的数据包。数据包是网络传输的最小数据单位。该层规定了通过怎样的路径到达对方计算机，并把数据包传送给对方。
* 链路层：用来处理连接网络的硬件部分。硬件上的范畴均在链路层的作用范围之内。

#### TCP/IP通信传输流

利用TCP/IP协议族进行网络通信时，会通过分层顺序与对方进行通信。

发送端在层与层之间传输数据时，每经过一层时必定会被打上一个该层所属的首部信息。反之，接受端在层与层传输数据时，每经过一层时会把对应的首部消去。这种把数据信息包装起来的做法称为封装（encapsulate）。

#### 与HTTP关系比切的协议：IP、TCP和DNS

##### 负责传输的IP协议

按层次分，IP（Internet Protocol）网际协议位于网络层。几乎所有使用网络的系统都会用到IP协议。

IP协议的作用是把各种数据包传送给对方。而要保证确实传送到对方那里，则需要满足格雷条件。其中两个重要的条件是IP地址和MAC地址（Media Access Control Address）。IP地址指明了节点被分配到的地址，MAC地址是指网卡所属的固定地址。IP地址可以和MAC地址进行配对。IP地址可变换，但MAC地址基本上不会更改。IP间的通信依赖MAC地址。

##### 确保可靠性的TCP协议

按层次分，TCP位于传输层，提供可靠的字节流服务。

字节流服务（Byte Stream Service）指为了方便传输，将大块数据分割成以报文段（segment）为单位的数据包进行管理。

为了准确无误地将数据送达目标处，TCP协议采用了三次握手（three-way handshaking）策略。握手过程中使用了TCP的标志（flag）——SYN（synchronize）和ACK（acknowledgement）。

发送端首先发送一个带SYN标志的数据包给对方。接收端收到后，回传一个带有SYN/ACK标志的数据包以示传达确认信息。最后，发送端再回传一个带ACK标志的数据包，代表“握手”结束。若在握手过程中某个阶段莫名中断，TCP协议会再次以相同的顺序发送相同的数据包。

##### 负责域名解析的DNS服务

DNS（Domain Name System）服务是和HTTP协议一样位于应用层的协议。它提供域名到IP地址之间的解析服务。

计算机既可以被赋予IP地址，也可以被赋予主机名和域名。DNS协议提供通过域名查找IP地址，或逆向从IP地址反查域名的服务。

### URI和URL

URI（统一资源标识符）和URL（统一资源定位符）。

URI是Uniform Resource Identifier的缩写。RFC2396分别对这3个单词进行了如下定义：

* Uniform：规定统一的格式可方便处理多种不同类型的资源，而不用根据上下文环境来识别资源指定的访问方式。
* Resource：资源的定义是“可标识的任何东西”。除了文档文件、图像或服务等能够区别于其他类型的，全都可作为资源。
* Identifier：表示可识别的对象。也称为标识符。

URI用字符串标识某一互联网资源，而URL表示资源的地点（互联网上所处的位置）。URL是URI的子集。

## 简单的HTTP协议

### HTTP协议用于客户端和服务器端之间的通信。

### 通过请求和响应的交换达成通信。

### HTTP是不保存状态的协议。


> [图解Http协议](http://www.bysocket.com/?p=282)